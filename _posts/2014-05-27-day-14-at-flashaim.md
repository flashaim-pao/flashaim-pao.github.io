---
layout: post
title: 'Day 14 at Flashaim'
date: 2014-05-27 02:51
image: ''
description: ''
categories:
    - 工作紀實
tags:
    - 新人日誌
    - 知識科技
 
---
# Mashup 備份策略

經過上次與這次的討論後決定，使用公司原有的主機搭配新買的 4 顆 4TB 硬碟組成 **RAID 5** 磁碟陣列。當然，若要更高的防護可以組成 **RAID 6** 犧牲多一些空間換取更高的容錯能力（一次可以壞兩顆硬碟）。此主機擁有 SATA 2/3 的插槽共 6 個，扣掉原先系統硬碟與光碟機還有 4 個，可說是剛剛好。

然而此方案需安裝 Linux ，才能透過 Kernal 提供 Softwore RAID 的能力。事實上，一些入門等級的 NAS（Network Attached Storage）內部也是用同樣的軟體構成的。

只是這台主機原先是用於 Mashup 測試之用，大夥們會把程式上傳上去進行測試。原先是安裝 Windows ，若改為 Ubuntu Linux 勢必不習慣操作。所幸此主機不僅記憶體有 16GB 還有四核心處裡器，足夠跑好幾台虛擬機器了。把原先的 Windows 測試環境移至虛擬機器內是個可行的方案。接著就待主機備妥硬碟，我再協助建立備份用的主機，以及備份工具與排程。

# Trace 專案

這邊則開始建立程式所使用的專案目錄。經過規劃與討論後，前台與後台都決定採用前後端分離的架構，而且是以前端為主的開發模式。為了能夠同步開發並考慮開發工具的影響，因此前台分為前後端兩個程式專案，而後台為了簡化則僅用一個程式專案。

不過在建立前台的前端專案時，遇到許多阻礙。即使用了 vagrant 但是仍要透過 npm 在啟動時自動安裝開發工具。而癥結點就發生在 npm 下載模組時，在冠宇家裡就是會下載失敗。所以我將 npm 所需的模組先安裝在系統內，並將運作中的 vagrant box 重新打包後，同步給其他人使用。希望這樣能解決問題，待明天測試。

# 行程規劃

除了建立前台的前端程式專案以外，也建立了後端程式專案。使用 Java 語言作為開發，並以 JAX-RS 規格開發 RESTful API 供前台呼叫。Reference Implementation 則使用 [Jersey](https://jersey.java.net) ，並符合 JAX-RS 2.0 規範。

雖然此專案還需要持續討論，例如功能需求以及操作模式等細節。然而有些功能可以先行開發，行程規劃就是一例。選取多個地點，並根據彼此間的距離求出繞行一圈最短的走法。這是經典的演算法問題**「[旅行銷售員問題][TSP]」**（Travelling salesman problem），他是一個 [NP-Hard][NP] 的組合問題。簡單地說，就是當他稍具規模就沒辦法在合理的時間內解出答案（暴力法）	。而 TSP 的難度會隨規模呈現非線性增長，因為他每個合法解答數量是 n! （n = 幾個地點）。簡單算一下數學：

| n | 合法解的數量 | 共要算多少次加法 |
| --------------------: | ------------------------: | -------------------------: |
| 5 | 120 | 480 | 
| 6 | 720 | 3,600 | 
| 7 | 5,040 | 30,240 | 
| 8 | 40,320 | 282,240 | 
| 9 | 362,880 | 2,903,040 | 
| 10 | 3,628,800 | 32,659,200 | 
| 20 |　2,432,902,008,176,640,000 |　46,225,138,155,356,200,000 | 

現在電腦跑很快，使用暴力法在 n = 10 以下也很輕鬆，不過到了 n = 20 似乎就不是那麼容易了。所以要用一些特別演算方法去求得最佳解。

能解 TSP 的演算法有相當多種，各有優劣以及不同的實作難度。不過幸運的是，旅遊行程規劃通常地點數量並不多，我們可以選擇一個簡單直覺的演算方法如[分支設限法][B&B]（Branch and bound Algorithm）。所以下午便開始實作此演算法，來作為 Trace 系統的第一項功能。

[TSP]: (http://en.wikipedia.org/wiki/Travelling_salesman_problem)
[NP]: (http://en.wikipedia.org/wiki/NP-hard)
[B&B]: (http://en.wikipedia.org/wiki/Branch_and_bound)


