---
layout: post
title: '工作紀實 2018年 12月'
date: 2018-12-31 21:00
image: ''
description: ''
categories:
    - 工作紀實
tags:
    - 月報
    - 知識科技
---

2018 最後一個月

# MS & FSB 產品

由於 MS 當年採用效能不高的 PHP/MySQL 所開發，加上其架構設計並未考慮效率，以致於整體吞吐量有限（FSB 基於 MS）。
近期由於客戶的 LINE@ 帳號透過廣告推廣，同時湧入的消費者使得系統過載，影響所有客戶的操作。
為了避免已排程的廣告再次發生這樣的嚴重狀況，我製作一個*前端緩衝器*，透過它放慢特定 LINE 帳戶的訊息速度即可避免癱瘓所有客戶。
由於高效能是第一考量，我直接採用了**沒碰過**的 ***GO*** 程式語言以及屬於 **NoCQL** 的 ***Cassandra*** 來開發此一程式。

而為了趕上廣告排程，我只好加班趕工（累）。幸虧最終完成的效能符合需求，僅用 2 cores CPU 與機械硬碟的主機，壓力測試跑出了 **peak 350** req/sec 的成績。
而且瓶頸是在 CPU ，Cassandra 的**寫入能力**超越我的預期，而系統上線後也順利解決了癱瘓的問題。
原本是二代產品才要用上的新技術線，沒想到臨時就提槍上陣了呢...(暈)

## 已完成

* #2054 實做一個訊息緩衝前端伺服器降低特定客戶的流量衝擊
* #2069 一對一手動派單 bug修復 拖用戶進群組會帶入其他人
* 設定客戶網域強制使用 HTTPS
* 修復資料庫同步備份
    + MySQL 副資料庫因故而資料損毀導致備份機制故障
    + 使用 GCP snapshot 取得完整資料重新同步副資料庫

# Beehive 產品

這是新產品線的內部**開發用代號**，由我們 R&D 票選而出，我個人覺得蠻貼切的，哈。

由於這產品線的特性，使得我們要採用新的技術線。
例如 GO 語言、各種 NoSQL 資料庫以及 K8S 叢集管理系統等，也使得這產品開發的難度高了許多。
因此以專任的開發小組負責，最終希望這產品線的開發經驗可以讓二代系統受益。

* 協助系統架構設計
* 使用 Azure 建立測試叢集並執行靜態網頁
    + K8S + Caddy web server + HTTPS
    + 已進行壓力測試： 8 cores CPU + SSD **連續壓載**達 **465** trans/sec, 0% failed

# 鍋專案

* 協助調整伺服器與主機提昇效能
* 協助改善特定頁面的前端程式效能

# 其他

* 協助調查客戶移機之後的效能問題
    + 調整伺服器與主機參數等
* 建置自動化快照於 S4 作為定時自動備份
* 協助調查客戶網域收信問題

# 後記

一眨眼已經是 2018 年底了呢，回顧這一年來，真、的、是、過、得、非、常、地、緊、湊（倒地）。
然後如同往年一樣地沒梗，希望來年一切順利～～～（傻笑）
